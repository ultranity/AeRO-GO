modified from: https://github.com/dev-shao/iprp/tree/main/message